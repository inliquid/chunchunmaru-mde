"use strict";function chunchunmaru(i,t){if(void 0===i)throw"First parameter, container id, cannot be null.";t=t||{};if((t=this.t=Object.assign({attributes:{id:"chunchunmaru-textarea",name:"chunchunmaru-textarea",placeholder:"Start writting!"},h:!1,o:!0,i:!1,m:"",u:!1,l:!0,v:!1,g:["bold","italic","|","link","blockquote","code","image","|","center","ol","ul","|","h1","h2","h3","h4","h5","h6","|","undo","redo"]},t)).i){if(this.p=document.querySelector(this.t.m),"undefined"==typeof marked)throw"marked is not defined";if(t.u&&"undefined"==typeof hljs)throw"highlight.js is not defined";var e=this.k={o:t.o,_:!0,j:!0,P:!1,O:!0,D:!1,M:!!t.u&&function(i,t){t=hljs.q(t)?t:"plaintext";return hljs.M(i,{language:t}).value},S:t.u?"hljs lang-":"lang-"};marked.T(e)}if(t.l){if("undefined"==typeof DOMPurify)throw"DOMPurify is not defined";DOMPurify.C("uponSanitizeElement",(i,t)=>{if("iframe"===t.tagName){const e=i.getAttribute("src")||"";if(!e.startsWith("https://www.youtube.com/embed/"))return i.parentNode.removeChild(i)}})}for(var h in this.H=document.getElementById(i),this.toolbar=document.createElement("div"),this.L=this.H.getElementsByTagName("textarea")[0]||document.createElement("textarea"),t.attributes){var n=t.attributes[h];this.L.getAttribute(h)||this.L.setAttribute(h,n)}this.H.className+="chunchumaru-container",this.toolbar.className+="chunchunmaru-editor-toolbar",this.L.className+="chunchunmaru-editor",this.H.appendChild(this.toolbar),this.H.appendChild(this.L),this.B=(i,t)=>{var e=this.L,h=e.value,n=e.selectionStart,o=e.selectionEnd,a=window.getSelection().toString(),r=i+a+t,t=h.substring(0,n),e=h.substring(o,e.value.length);this.L.value=t+r+e,this.L.focus(),this.L.selectionStart=n+i.length+a.length,this.L.selectionEnd=n+i.length+a.length},this.F=i=>{var t=this.L.value,e=this.L.selectionStart,h=t.substring(0,e),t=t.substring(e,t.length);this.L.value=h+i+t,this.L.selectionStart=e+i.length,this.L.selectionEnd=e+i.length},this.$=i=>{var t=this.L,e=t.selectionStart,h=t.selectionEnd;if(e==h)(a=t.value.substr(0,e).split("\n"))[a.length-1]=i+a[a.length-1];else{var n=t.value.substr(0,e).split("\n").length-1,o=t.value.substr(0,h).split("\n").length-1,a=t.value.split("\n");for(o<n&&(t=o,o=n,n=t);n<=o;)a[n]=i+a[n],n+=1}this.L.value=a.join("\n"),this.L.focus()},this.A=i=>{var t=this.L,e=t.selectionStart,h=t.selectionEnd,n=1;if(e==h)(r=t.value.substr(0,e).split("\n"))[r.length-1]=n+r[r.length-1];else{var o=t.value.substr(0,e).split("\n").length-1,a=t.value.substr(0,h).split("\n").length-1,r=t.value.split("\n");for(a<o&&(t=a,a=o,o=t);o<=a;)r[o]=`${n}. `+r[o],o+=1,n+=1}this.L.value=r.join("\n"),this.L.focus()},this.G=()=>{this.L.innerHTML=this.L.value},this.I=()=>{var i=marked(this.L.value);return t.l?DOMPurify.l(i):i},this.J=i=>{i=marked(i);return t.l?DOMPurify.l(i):i};var o=[""],a=[];this.K={b:i=>{i.ctrlKey&&this.B("**","**")},N:i=>{i.ctrlKey&&this.B("*","*")},R:i=>{i.ctrlKey||i.shiftKey||i.altKey||this.F("    ")}},this.K=Object.assign(this.K,t.K),this.U=()=>{1<o.length&&(a.push(this.L.value),this.L.value=o.pop())},this.V=()=>{a.length&&(o.push(this.L.value),this.L.value=a.pop())},this.L.addEventListener("keyup",i=>{i.key in this.K&&this.K[i.key](i),t.i&&(this.p.innerHTML=this.I()),this.L.innerHTML=this.L.value}),this.L.addEventListener("keydown",i=>{var t=i.key;" "!==t&&"Backspace"!==t&&"Delete"!==t||(a.length&&(a=[]),20<o.length&&o.shift(),o.push(this.L.value)),i.ctrlKey&&"z"===t&&(i.preventDefault(),this.U()),i.ctrlKey&&"y"===t&&(i.preventDefault(),this.V()),"Tab"===t&&i.preventDefault()});var r={bold:{action:()=>{this.B("**","**")},icon:"mdi mdi-format-bold"},W:{action:()=>{this.B("*","*")},icon:"mdi mdi-format-italic"},link:{action:()=>{this.B("[link_","](put_your_link_url_here)")},icon:"mdi mdi-link-variant"},X:{action:()=>{this.$("> ")},icon:"mdi mdi-format-quote-close"},code:{action:()=>{},icon:"mdi mdi-code-braces"},Y:{action:()=>{this.B("![image_","](put_your_image_url_here)")},icon:"mdi mdi-image"},Z:{action:()=>{this.B("<div align='center'>\n\n","\n\n</div>")},icon:"mdi mdi-format-align-center"},ii:{action:()=>{this.A()},icon:"mdi mdi-format-list-numbered"},ti:{action:()=>{this.$("- ")},icon:"mdi mdi-format-list-bulleted"},ei:{action:()=>{this.$("# ")},icon:"mdi mdi-format-header-1"},hi:{action:()=>{this.$("## ")},icon:"mdi mdi-format-header-2"},ni:{action:()=>{this.$("### ")},icon:"mdi mdi-format-header-3"},oi:{action:()=>{this.$("#### ")},icon:"mdi mdi-format-header-4"},ai:{action:()=>{this.$("##### ")},icon:"mdi mdi-format-header-5"},ri:{action:()=>{this.$("###### ")},icon:"mdi mdi-format-header-6"},si:{action:()=>{this.U()},icon:"mdi mdi-undo"},di:{action:()=>{this.V()},icon:"mdi mdi-redo"}};this.ci=()=>{var i,t,e,h;for(i of this.t.g)i in r?(t=r[i],(e=document.createElement("i")).className+="toolbar-button-icon "+t.icon,(h=document.createElement("button")).onclick=t.action,h.type="button",h.appendChild(e),this.toolbar.appendChild(h)):"|"===i&&((h=document.createElement("hr")).setAttribute("role","separator"),h.setAttribute("aria-orientation","vertical"),h.className+="toolbar-button-divider",this.toolbar.appendChild(h))},this.ci(),t.i&&(this.p.innerHTML=this.I())}"function"==typeof require&&"object"==typeof exports&&"object"==typeof module?module.exports=chunchunmaru:window.mi=chunchunmaru;